<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>7emlaghkem<333</title>
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='0.9em' font-size='90'%3EðŸ’œ%3C/text%3E%3C/svg%3E">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: #000;
            color: white;
            overflow: hidden;
            height: 100vh;
            width: 100vw;
            -webkit-tap-highlight-color: transparent;
        }
        .level {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            transition: opacity 1s ease, visibility 1s ease;
            padding: 20px;
            visibility: hidden; opacity: 0; pointer-events: none;
        }
        .level.active {
            visibility: visible; opacity: 1; pointer-events: all;
        }

        /* LEVEL 1 */
        #level-1 { background: #000; }
        .sequence-text {
            font-size: clamp(2rem, 8vw, 4rem);
            margin-bottom: 1.5rem; text-align: center;
            opacity: 0; transform: translateY(20px);
            transition: opacity 1s ease, transform 1s ease;
        }
        .sequence-text.show { opacity: 1; transform: translateY(0); }
        .font-1 { font-family: 'Georgia', serif; font-weight: 700; }
        .font-2 { font-family: 'Courier New', monospace; font-weight: 400; letter-spacing: 3px; }
        .font-3 { font-family: 'Arial', sans-serif; font-weight: 300; font-style: italic; }
        .font-4 { font-family: 'Verdana', sans-serif; font-weight: 400; }
        #start-btn {
            margin-top: 3rem; padding: 1rem 3rem; font-size: 1.5rem;
            background: white; color: black; border: none; border-radius: 50px;
            cursor: pointer; transition: all 0.3s ease;
            opacity: 0; transform: scale(0.9);
            font-weight: 600; letter-spacing: 1px;
        }
        #start-btn.show { opacity: 1; transform: scale(1); }
        #start-btn:hover { background: #f0f0f0; transform: scale(1.05); }
        .question-screen {
            position: absolute; display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            width: 100%; height: 100%;
            opacity: 0; pointer-events: none; transition: opacity 0.8s ease;
        }
        .question-screen.active { opacity: 1; pointer-events: all; }
        .question {
            font-size: clamp(2rem, 8vw, 4rem); margin-bottom: 3rem;
            text-align: center; font-family: 'Georgia', serif;
        }
        .button-container {
            display: flex; gap: 2rem; position: relative;
            min-height: 120px; flex-wrap: wrap; justify-content: center;
            z-index: 10;
        }
        #yes-btn {
            padding: 1rem 2.5rem; font-size: 1.8rem;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white; border: none; border-radius: 12px;
            cursor: pointer; font-weight: 600; transition: transform 0.2s ease, box-shadow 0.2s ease;
            box-shadow: 0 10px 20px rgba(16, 185, 129, 0.2);
            position: relative;
            z-index: 2;
            will-change: transform;
        }
        #yes-btn:hover { transform: scale(1.05); box-shadow: 0 15px 30px rgba(16, 185, 129, 0.3); }
        #no-btn {
            padding: 1rem 2.5rem; font-size: 1.8rem;
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white; border: none; border-radius: 12px;
            cursor: pointer; font-weight: 600; transition: box-shadow 0.2s ease;
            box-shadow: 0 10px 20px rgba(239, 68, 68, 0.2);
            position: absolute; 
            pointer-events: auto;
            z-index: 3;
            transform: translateX(-180px); /* far left */
            will-change: transform;
        }

        /* LEVEL 2 */
        #level-2 {
            background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
            background-size: 400% 400%; animation: gradient 15s ease infinite;
        }
        @keyframes gradient { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        .phrase {
            font-size: clamp(1.8rem, 6vw, 3.5rem); margin-bottom: 2rem; text-align: center;
            opacity: 0; transform: translateY(30px); transition: opacity 0.8s ease, transform 0.8s ease;
            color: white; text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        .phrase.show { opacity: 1; transform: translateY(0); }
        .progress-container {
            width: min(300px,80%); height: 4px; background: rgba(255,255,255,0.2);
            border-radius: 2px; margin: 3rem 0; overflow: hidden;
        }
        #progress-bar {
            height: 100%; width: 0%; background: linear-gradient(90deg, #fff, #f0f0f0);
            border-radius: 2px; transition: width 1s ease;
        }
        #next-btn {
            padding: 1rem 3rem; font-size: 1.5rem;
            background: rgba(255,255,255,0.15); backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.3); border-radius: 50px;
            cursor: pointer; transition: all 0.5s ease;
            opacity: 0.5; pointer-events: none; font-weight: 600; letter-spacing: 1px;
        }
        #next-btn.ready { opacity: 1; pointer-events: all; animation: float 3s ease-in-out infinite; }
        #next-btn.ready:hover { background: rgba(255,255,255,0.25); transform: scale(1.05); }
        @keyframes float { 0%,100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }

        /* LEVEL 3 */
        #level-3 { background: linear-gradient(135deg, #4c1d95, #2e1065, #1e1b4b); }
        .confetti {
            position: absolute; width: 10px; height: 10px; background: #f0f0f0; opacity: 0;
        }
        .letter-container {
            max-width: 800px; width: 90%;
            background: rgba(255,255,255,0.1); backdrop-filter: blur(20px);
            border-radius: 20px; padding: clamp(1.5rem,5vw,3rem);
            border: 1px solid rgba(255,255,255,0.2); box-shadow: 0 25px 50px rgba(0,0,0,0.5);
            opacity: 0; transform: translateY(30px);
            transition: opacity 1s ease 0.5s, transform 1s ease 0.5s;
        }
        #level-3.active .letter-container { opacity: 1; transform: translateY(0); }
        .letter-content {
            font-size: clamp(1rem,4vw,1.3rem); line-height: 1.8; margin-bottom: 2rem;
            color: rgba(255,255,255,0.9); text-align: center;
        }
        .signature { text-align: center; border-top: 1px solid rgba(255,255,255,0.2); padding-top: 2rem; margin-top: 2rem; }
        .signature-line { font-size: 1rem; color: rgba(255,255,255,0.7); letter-spacing: 3px; margin-bottom: 0.5rem; }
        .signature-name { font-size: clamp(1.5rem,5vw,2rem); color: white; font-family: 'Georgia', serif; font-style: italic; }
        #continue-btn {
            margin-top: 2rem; padding: 0.8rem 2rem;
            background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.3);
            border-radius: 30px; color: white; font-size: 1.2rem; cursor: pointer;
            opacity: 0; transform: translateY(20px);
            transition: opacity 0.5s ease, transform 0.5s ease;
        }
        #continue-btn.show { opacity: 1; transform: translateY(0); }
        #continue-btn:hover { background: rgba(255,255,255,0.3); }

        /* LEVEL 4 - SNAIL (purple, no audio, only continue button) */
        #level-4 {
            background: #000;
            overflow: hidden; 
            position: relative;
            transition: background-color 10s ease;
        }
        #snail {
            height: 75px; width: 120px;
            position: absolute; z-index: 10;
            top: 50%; left: -120px;
            transform: translateY(-50%);
            animation: snailCrawl 25s linear forwards;
        }
        #shell {
            height: 64px; width: 74px; border-radius: 100%;
            background: rgb(130, 50, 180);
            background: linear-gradient(to right, #8232b4 44%, #8232b4 51%, #501482 100%);
            position: absolute; z-index: 1; top: 5px; left: 20px; overflow: visible; transform: rotate(20deg);
        }
        #shell:after {
            content: ''; display: block; position: absolute; right: 49px;
            width: 0; height: 0; border-right: 54px solid #8232b4;
            border-top: 32px solid transparent; border-bottom: 32px solid transparent;
            border-radius: 64px;
        }
        #slug {
            width: 170px; height: 30px; position: absolute; bottom: 0; right: 0;
            background: #b19cd9;
            border-radius: 0 15px 5px 0;
            animation: slugSquish 1.25s ease-in-out infinite;
        }
        #slug:before {
            content: '.'; font-size: 50px; line-height: 0px; color: transparent;
            text-shadow: -7px -12px 0 rgb(183,223,45), -1px -7px 0 rgb(183,223,45);
            display: block; position: absolute; height: 30px; width: 2px; background: #b19cd9;
            right: 10px; top: -25px; transform: rotate(30deg); box-shadow: 6px 5px 0 #b19cd9;
        }
        #slug:after {
            content: ''; display: block; position: absolute; bottom: 0px; left: -100px;
            height: 0; width: 0; border-left: 100px solid transparent; border-bottom: 40px solid #b19cd9;
        }
        #slime {
            height: 5px; width: 50%;
            background: linear-gradient(to right, rgba(200,150,255,0) 0%, rgba(200,150,255,1) 100%);
            position: absolute; z-index: 5; top: 50%; left: -50%; transform: translateY(-50%);
            animation: slimeSpread 25s linear forwards; border-radius: 3px;
        }
        @keyframes snailCrawl {
            0% { left: -120px; }
            100% { left: calc(100% + 120px); }
        }
        @keyframes slimeSpread {
            0% { left: -50%; opacity: .5; }
            95% { opacity: .5; }
            100% { left: calc(50% + 240px); opacity: 0; }
        }
        @keyframes slugSquish {
            0% { width: 50px; right: -5px; }
            50% { width: 40px; right: 0px; }
            100% { width: 50px; right: -5px; }
        }
        .snail-text {
            position: absolute; bottom: 30%; left: 0; width: 100%;
            text-align: center; color: rgba(255,255,255,0.8);
            font-size: clamp(1.2rem,5vw,2rem);
            opacity: 0; transition: opacity 1s ease; pointer-events: none;
            text-shadow: 0 0 10px purple; padding: 0 20px; z-index: 20;
        }
        .snail-text.show { opacity: 1; }
        /* Continue button after snail */
        #snail-continue {
            position: absolute; bottom: 15%; left: 50%; transform: translateX(-50%);
            padding: 1rem 2.5rem; background: rgba(255,255,255,0.2);
            border: 1px solid white; border-radius: 40px; color: white;
            font-size: 1.3rem; cursor: pointer; opacity: 0; transition: opacity 0.5s;
            z-index: 30; white-space: nowrap;
            backdrop-filter: blur(10px);
        }
        #snail-continue.show { opacity: 1; }
        #snail-continue:hover { background: rgba(255,255,255,0.3); transform: translateX(-50%) scale(1.05); }

        /* LEVEL 5 - Coming Soon */
        #level-5 {
            background: #0d001a;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        .coming-soon {
            font-size: clamp(3rem, 10vw, 6rem);
            font-weight: 800;
            color: #c084fc;
            text-shadow: 0 0 30px #c084fc, 0 0 60px #a855f7, 0 0 90px #7e22ce;
            animation: neonPulse 2s ease-in-out infinite;
            letter-spacing: 8px;
            margin-bottom: 2rem;
        }
        @keyframes neonPulse {
            0% { text-shadow: 0 0 30px #c084fc, 0 0 60px #a855f7, 0 0 90px #7e22ce; }
            50% { text-shadow: 0 0 50px #d8b4fe, 0 0 80px #c084fc, 0 0 120px #a855f7; }
            100% { text-shadow: 0 0 30px #c084fc, 0 0 60px #a855f7, 0 0 90px #7e22ce; }
        }
        .countdown-big {
            font-size: clamp(2rem, 6vw, 4rem);
            font-family: monospace;
            color: #e9d5ff;
            text-shadow: 0 0 20px #a855f7;
            margin-top: 2rem;
        }
        .countdown-label {
            font-size: 1.2rem;
            letter-spacing: 4px;
            color: rgba(255,255,255,0.7);
        }

        @media (max-width: 600px) {
            .button-container { gap: 1rem; }
            #yes-btn, #no-btn { font-size: 1.4rem; padding: 0.8rem 1.5rem; }
        }

        @media (prefers-reduced-motion: reduce) {
            * { animation-duration: 0.01ms !important; animation-iteration-count: 1 !important; transition-duration: 0.01ms !important; }
        }
    </style>
</head>
<body>
    <!-- Level 1 -->
    <div id="level-1" class="level active">
        <div id="init-sequence">
            <div id="q1" class="sequence-text font-1">Are you ready?</div>
            <div id="q2" class="sequence-text font-2">Sure?</div>
            <div id="q3" class="sequence-text font-3">Hmmâ€¦</div>
            <div id="q4" class="sequence-text font-4">Okay. Let's start.</div>
        </div>
        <button id="start-btn">START</button>
        <div id="question-screen" class="question-screen">
            <div class="question">Do you love me?</div>
            <div class="button-container">
                <button id="yes-btn">Yes</button>
                <button id="no-btn">No</button>
            </div>
        </div>
    </div>

    <!-- Level 2 -->
    <div id="level-2" class="level">
        <div id="phrase-1" class="phrase">You chose with intention.</div>
        <div id="phrase-2" class="phrase">Good.</div>
        <div id="phrase-3" class="phrase">Keep going.</div>
        <div class="progress-container"><div id="progress-bar"></div></div>
        <button id="next-btn">One last step</button>
    </div>

    <!-- Level 3 -->
    <div id="level-3" class="level">
        <div id="confetti-container"></div>
        <div class="letter-container">
            <div class="letter-content">
                I'm proud of you in a way that doesn't need noise. You carry yourself with strength, and I meet you thereâ€”steady, sure, unshaken. When I call you my baby, it's not softness, it's intention: I choose you, I hold you, and you feel it. Older or not, you know exactly why you lean into me, i love u, i adore u, u are my spark of light in the darkness, u are my warmth in the frost, i love u ikram<3
            </div>
            <div class="signature">
                <div class="signature-line">Always.</div>
                <div class="signature-name">Your loving husband, Sidou</div>
            </div>
            <button id="continue-btn">One more thing...</button>
        </div>
    </div>

    <!-- Level 4 - Snail (purple, no audio, only continue button) -->
    <div id="level-4" class="level">
        <div id="snail"><div id="shell"></div><div id="slug"></div></div>
        <div id="slime"></div>
        <div id="snail-text-1" class="snail-text">Wait...</div>
        <div id="snail-text-2" class="snail-text">Do you remember?</div>
        <div id="snail-text-3" class="snail-text">You're the softest thing I've ever held.</div>
        <div id="snail-text-4" class="snail-text">I never want to let go.</div>
        <button id="snail-continue">Continue â†’</button>
    </div>

    <!-- Level 5 - Coming Soon -->
    <div id="level-5" class="level">
        <div class="coming-soon">COMING SOON</div>
        <div class="countdown-big" id="countdown-big"></div>
        <div class="countdown-label">until October 14, 2026</div>
    </div>

    <script>
        (function() {
            "use strict";

            // ---------- Level elements ----------
            const levels = {
                l1: document.getElementById('level-1'),
                l2: document.getElementById('level-2'),
                l3: document.getElementById('level-3'),
                l4: document.getElementById('level-4'),
                l5: document.getElementById('level-5')
            };

            // Level 1 elements
            const startBtn = document.getElementById('start-btn');
            const yesBtn = document.getElementById('yes-btn');
            const noBtn = document.getElementById('no-btn');
            const questionScreen = document.getElementById('question-screen');
            const qElements = ['q1','q2','q3','q4'].map(id => document.getElementById(id));

            // Level 2 elements
            const phrase1 = document.getElementById('phrase-1');
            const phrase2 = document.getElementById('phrase-2');
            const phrase3 = document.getElementById('phrase-3');
            const progressBar = document.getElementById('progress-bar');
            const nextBtn = document.getElementById('next-btn');

            // Level 3 elements
            const continueBtn = document.getElementById('continue-btn');
            const confettiContainer = document.getElementById('confetti-container');

            // Level 4 elements
            const snail = document.getElementById('snail');
            const snailTexts = [
                document.getElementById('snail-text-1'),
                document.getElementById('snail-text-2'),
                document.getElementById('snail-text-3'),
                document.getElementById('snail-text-4')
            ];
            const snailContinue = document.getElementById('snail-continue');

            // Level 5 elements
            const countdownBig = document.getElementById('countdown-big');

            // ---------- State ----------
            let currentLevel = 'l1';
            let noBtnX = -180, noBtnY = 0; // base offset
            let noBtnVX = 0, noBtnVY = 0; // velocity for spring
            let noBtnAnimationFrame = null;
            let yesBtnSize = 1;
            let noBtnListenerActive = false;
            const timers = [];

            // ---------- Utility: Cleanup ----------
            function clearAllTimers() {
                timers.forEach(t => clearTimeout(t));
                timers.length = 0;
                if (countdownInterval) {
                    clearInterval(countdownInterval);
                    countdownInterval = null;
                }
                if (noBtnAnimationFrame) {
                    cancelAnimationFrame(noBtnAnimationFrame);
                    noBtnAnimationFrame = null;
                }
            }

            // ---------- Level switching ----------
            function switchLevel(toLevel) {
                if (currentLevel === toLevel) return;
                clearAllTimers();
                if (currentLevel === 'l1') {
                    document.removeEventListener('pointermove', onPointerMove);
                    noBtnListenerActive = false;
                }
                if (currentLevel === 'l5' && countdownInterval) {
                    clearInterval(countdownInterval);
                }
                levels[currentLevel].classList.remove('active');
                levels[toLevel].classList.add('active');
                currentLevel = toLevel;

                if (toLevel === 'l1') {
                    // re-init if needed
                } else if (toLevel === 'l2') {
                    startLevel2();
                } else if (toLevel === 'l3') {
                    startLevel3();
                } else if (toLevel === 'l4') {
                    startLevel4();
                } else if (toLevel === 'l5') {
                    startLevel5();
                }
            }

            // ---------- Level 1: sequence and Yes/No ----------
            function showSequence() {
                const delays = [500, 2000, 3500, 5000];
                qElements.forEach((el, i) => {
                    const t = setTimeout(() => el.classList.add('show'), delays[i]);
                    timers.push(t);
                });
                const t = setTimeout(() => startBtn.classList.add('show'), 6000);
                timers.push(t);
            }

            function initYesNo() {
                if (noBtnListenerActive) return;
                noBtnListenerActive = true;
                document.addEventListener('pointermove', onPointerMove, { passive: true });
            }

            function onPointerMove(e) {
                const mouseX = e.clientX;
                const mouseY = e.clientY;
                const rect = noBtn.getBoundingClientRect();
                const btnCenterX = rect.left + rect.width/2;
                const btnCenterY = rect.top + rect.height/2;
                const dist = Math.hypot(mouseX - btnCenterX, mouseY - btnCenterY);

                if (dist < 150) { // increased radius for smoother response
                    const angle = Math.atan2(btnCenterY - mouseY, btnCenterX - mouseX);
                    const force = Math.max(0, 1 - dist / 150) * 25; // force diminishes with distance
                    const ax = Math.cos(angle) * force;
                    const ay = Math.sin(angle) * force;

                    // Apply acceleration to velocity
                    noBtnVX += ax;
                    noBtnVY += ay;

                    // Damping
                    noBtnVX *= 0.9;
                    noBtnVY *= 0.9;

                    // Update position
                    noBtnX += noBtnVX;
                    noBtnY += noBtnVY;

                    // Strong boundaries: keep within viewport edges
                    const maxX = window.innerWidth - rect.width - 20; // right edge
                    const minX = 20; // left edge
                    const maxY = window.innerHeight - rect.height - 20;
                    const minY = 20;

                    // Convert global desired position to local transform offset
                    // noBtnX is the transform offset from its initial -180px.
                    // We need to ensure the button stays on screen.
                    // Let's compute the actual left position: initial left is at 50%? Actually it's absolutely positioned.
                    // Simpler: clamp the transform so the button's bounding box stays within safe area.
                    // We'll approximate by clamping noBtnX between -280 and 80 (since base is -180, width ~150)
                    noBtnX = Math.max(-280, Math.min(80, noBtnX));
                    noBtnY = Math.max(-150, Math.min(150, noBtnY));

                    noBtn.style.transform = `translate(${noBtnX}px, ${noBtnY}px)`;

                    // Yes button grows
                    yesBtnSize = Math.min(2.5, yesBtnSize + 0.02);
                    yesBtn.style.transform = `scale(${yesBtnSize})`;
                    if (yesBtnSize > 1.2) yesBtn.textContent = 'YES';
                    if (yesBtnSize > 1.8) yesBtn.textContent = 'YES.';
                    if (yesBtnSize > 2.2) yesBtn.textContent = 'YES!';
                } else {
                    // Return gently to base
                    const targetX = -180;
                    const targetY = 0;
                    const dx = targetX - noBtnX;
                    const dy = targetY - noBtnY;
                    noBtnVX += dx * 0.03;
                    noBtnVY += dy * 0.03;
                    noBtnVX *= 0.9;
                    noBtnVY *= 0.9;
                    noBtnX += noBtnVX;
                    noBtnY += noBtnVY;
                    noBtn.style.transform = `translate(${noBtnX}px, ${noBtnY}px)`;

                    // Shrink yes slightly if far
                    if (yesBtnSize > 1) {
                        yesBtnSize = Math.max(1, yesBtnSize - 0.01);
                        yesBtn.style.transform = `scale(${yesBtnSize})`;
                    }
                }

                if (noBtnAnimationFrame) cancelAnimationFrame(noBtnAnimationFrame);
                noBtnAnimationFrame = requestAnimationFrame(updateLoop);
            }

            function updateLoop() {
                // Continuous physics update
                if (currentLevel !== 'l1') return;

                // Apply damping and boundaries
                noBtnVX *= 0.98;
                noBtnVY *= 0.98;
                noBtnX += noBtnVX;
                noBtnY += noBtnVY;

                // Boundaries
                noBtnX = Math.max(-280, Math.min(80, noBtnX));
                noBtnY = Math.max(-150, Math.min(150, noBtnY));

                noBtn.style.transform = `translate(${noBtnX}px, ${noBtnY}px)`;

                // Yes size decay
                if (yesBtnSize > 1) {
                    yesBtnSize = Math.max(1, yesBtnSize - 0.005);
                    yesBtn.style.transform = `scale(${yesBtnSize})`;
                }

                if (Math.abs(noBtnVX) > 0.01 || Math.abs(noBtnVY) > 0.01 || Math.abs(noBtnX + 180) > 0.1 || Math.abs(noBtnY) > 0.1 || yesBtnSize > 1.01) {
                    noBtnAnimationFrame = requestAnimationFrame(updateLoop);
                } else {
                    noBtnAnimationFrame = null;
                }
            }

            function showQuestion() {
                document.getElementById('init-sequence').style.opacity = '0';
                startBtn.style.opacity = '0';
                const t = setTimeout(() => {
                    questionScreen.classList.add('active');
                    initYesNo();
                }, 500);
                timers.push(t);
            }

            // ---------- Level 2 ----------
            function startLevel2() {
                progressBar.style.width = '0%';
                phrase1.classList.remove('show');
                phrase2.classList.remove('show');
                phrase3.classList.remove('show');
                nextBtn.classList.remove('ready');

                const t1 = setTimeout(() => {
                    phrase1.classList.add('show');
                    progressBar.style.width = '33%';
                }, 500);
                const t2 = setTimeout(() => {
                    phrase2.classList.add('show');
                    progressBar.style.width = '66%';
                }, 2500);
                const t3 = setTimeout(() => {
                    phrase3.classList.add('show');
                    progressBar.style.width = '100%';
                }, 4500);
                const t4 = setTimeout(() => {
                    nextBtn.classList.add('ready');
                }, 5500);
                timers.push(t1, t2, t3, t4);
            }

            // ---------- Level 3 ----------
            function startLevel3() {
                createConfetti(confettiContainer, 100, [
                    '#ff6b6b','#4ecdc4','#45b7d1','#96ceb4','#feca57','#ff9ff3','#c56cf0'
                ]);
                const t = setTimeout(() => continueBtn.classList.add('show'), 2000);
                timers.push(t);
            }

            function createConfetti(container, count, colors) {
                for (let i = 0; i < count; i++) {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    const size = Math.random()*10+5;
                    confetti.style.width = `${size}px`;
                    confetti.style.height = `${size}px`;
                    confetti.style.backgroundColor = colors[Math.floor(Math.random()*colors.length)];
                    confetti.style.left = `${Math.random()*100}%`;
                    confetti.style.top = '-20px';
                    confetti.style.borderRadius = '2px';
                    container.appendChild(confetti);
                    const delay = Math.random()*2;
                    const duration = 3+Math.random()*4;
                    setTimeout(() => {
                        confetti.style.transition = `all ${duration}s cubic-bezier(0.1,0.8,0.2,1)`;
                        confetti.style.opacity = '1';
                        confetti.style.transform = `translateY(calc(100vh + 20px)) rotate(${Math.random()*720}deg)`;
                        setTimeout(() => confetti.remove(), duration*1000);
                    }, delay*1000);
                }
            }

            // ---------- Level 4 ----------
            function startLevel4() {
                snail.style.animation = 'none';
                snail.offsetHeight;
                snail.style.animation = 'snailCrawl 25s linear forwards';

                levels.l4.style.transition = 'background-color 10s ease';
                levels.l4.style.backgroundColor = '#2a0f3a';

                snailContinue.classList.remove('show');
                snailTexts.forEach(t => t.classList.remove('show'));

                const delays = [2000, 7000, 13000, 19000];
                const showTexts = [
                    () => snailTexts[0].classList.add('show'),
                    () => {
                        snailTexts[0].classList.remove('show');
                        snailTexts[1].classList.add('show');
                    },
                    () => {
                        snailTexts[1].classList.remove('show');
                        snailTexts[2].classList.add('show');
                    },
                    () => {
                        snailTexts[2].classList.remove('show');
                        snailTexts[3].classList.add('show');
                    }
                ];
                delays.forEach((delay, idx) => {
                    const t = setTimeout(showTexts[idx], delay);
                    timers.push(t);
                });

                // After last text, show continue button
                const t = setTimeout(() => {
                    snailTexts[3].classList.remove('show');
                    snailContinue.classList.add('show');
                }, 21000);
                timers.push(t);
            }

            // ---------- Level 5 ----------
            let countdownInterval = null;
            function startLevel5() {
                updateCountdown();
                countdownInterval = setInterval(updateCountdown, 1000);
            }

            function updateCountdown() {
                const target = new Date(2026, 9, 14, 0, 0, 0);
                const now = new Date();
                const diff = target - now;
                if (diff <= 0) {
                    countdownBig.innerText = '00:00:00:00';
                    return;
                }
                const d = Math.floor(diff / (1000 * 60 * 60 * 24));
                const h = Math.floor((diff / (1000 * 60 * 60)) % 24);
                const m = Math.floor((diff / (1000 * 60)) % 60);
                const s = Math.floor((diff / 1000) % 60);
                countdownBig.innerText = `${d.toString().padStart(2,'0')}:${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
            }

            // ---------- Event listeners ----------
            startBtn.addEventListener('click', showQuestion);
            yesBtn.addEventListener('click', () => {
                if (navigator.vibrate) navigator.vibrate(50);
                switchLevel('l2');
            });
            nextBtn.addEventListener('click', () => switchLevel('l3'));
            continueBtn.addEventListener('click', () => switchLevel('l4'));
            snailContinue.addEventListener('click', () => switchLevel('l5'));

            // Safety timeout for level 1 text
            const safety = setTimeout(() => {
                qElements.forEach(el => el.classList.add('show'));
                startBtn.classList.add('show');
            }, 7000);
            timers.push(safety);

            // Start experience
            showSequence();

            // Cleanup on page unload
            window.addEventListener('beforeunload', () => {
                clearAllTimers();
            });

            // ARIA management for accessibility
            function updateAria() {
                Object.keys(levels).forEach(key => {
                    const level = levels[key];
                    const isActive = level.classList.contains('active');
                    level.setAttribute('aria-hidden', !isActive);
                    level.querySelectorAll('button, [tabindex]').forEach(el => {
                        if (!isActive) el.setAttribute('tabindex', '-1');
                        else el.removeAttribute('tabindex');
                    });
                });
            }
            // Override switchLevel to call updateAria
            const originalSwitch = switchLevel;
            switchLevel = function(toLevel) {
                originalSwitch(toLevel);
                updateAria();
            };
            updateAria();
        })();
    </script>
</body>
</html>
